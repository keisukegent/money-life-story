<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ãƒãƒãƒ¼ãƒ©ã‚¤ãƒ•ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ï½œeãƒ©ãƒ¼ãƒ‹ãƒ³ã‚°ä½“é¨“ç‰ˆï¼ˆéŸ³å£°ãªã—ï¼‰</title>
<style>
  body {
    font-family: 'Hiragino Maru Gothic Pro', 'Yu Gothic', system-ui, sans-serif;
    background: linear-gradient(135deg, #f9e0e9, #d8e9f0);
    text-align: center;
    color: #444;
    padding: 20px;
    min-height: 100vh;
    overflow-x: hidden;
  }
  h1 { color: #d06ba0; animation: fadeIn 1.2s ease; }
  #game {
    background: rgba(255, 255, 255, 0.94);
    border-radius: 20px;
    padding: 20px;
    max-width: 740px;
    margin: 22px auto;
    box-shadow: 0 8px 20px rgba(0,0,0,0.15);
    animation: slideUp 0.8s ease;
  }
  .row { display: flex; gap: 10px; justify-content: center; flex-wrap: wrap; }
  button {
    margin: 10px;
    padding: 12px 18px;
    border: none;
    border-radius: 12px;
    background: linear-gradient(90deg, #f7b7c1, #fbd5b5);
    color: white;
    font-size: 16px;
    cursor: pointer;
    transition: transform 0.2s, box-shadow 0.2s;
  }
  button:hover { transform: translateY(-3px); box-shadow: 0 4px 10px rgba(0,0,0,0.2); }

  .status { background: linear-gradient(90deg, #fff4fa, #f0faff); border-radius: 10px; padding: 12px; margin: 10px 0; animation: fadeIn 0.6s ease; }
  #event { font-size: 18px; margin: 18px 0; animation: fadeIn 0.6s ease; }

  /* ã‚³ãƒ¼ãƒãƒœãƒƒã‚¯ã‚¹ */
  .coach-box { display: none; align-items: center; gap: 12px; max-width: 600px; margin: 8px auto 0; padding: 12px; border-radius: 14px; background: #fff9fd; border: 1px solid #f3d4e5; box-shadow: 0 4px 10px rgba(208,107,160,0.08); opacity: 0; transform: translateY(8px); }
  .coach-avatar { width: 56px; height: 56px; border-radius: 50%; overflow: hidden; background: #ffeaf4; display: grid; place-items: center; }
  .coach-avatar img { width: 56px; height: 56px; display: block; }
  .coach-name { font-weight: 700; color: #c65e97; font-size: 14px; margin-bottom: 4px; }
  .coach-text { text-align: left; line-height: 1.6; }

  @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
  @keyframes slideUp { from { transform: translateY(40px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
  @keyframes fadeInUp { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }

  /* ãã‚‰ãã‚‰æ¼”å‡º */
  .sparkle { position: fixed; width: 10px; height: 10px; background: radial-gradient(circle, #fff 0%, transparent 70%); border-radius: 50%; animation: fall 4s linear infinite; opacity: 0.7; pointer-events: none; }
  @keyframes fall { 0% { transform: translateY(-10px); opacity: 1; } 100% { transform: translateY(110vh); opacity: 0; } }

  .note { font-size: 12px; color: #777; }
  .pill { display:inline-block; padding:4px 10px; border-radius: 999px; background:#f3e7ef; color:#a34f84; font-size:12px; margin-left:6px; }

  /* ã‚³ãƒ¼ãƒé¸æŠç”»é¢ */
  .select-wrap { display:grid; grid-template-columns: repeat(auto-fit, minmax(200px,1fr)); gap:14px; max-width: 700px; margin: 10px auto; }
  .coach-card { background:#fff; border:1px solid #f0d2e2; border-radius:16px; padding:14px; box-shadow:0 6px 14px rgba(0,0,0,0.06); transition: transform .2s, box-shadow .2s; }
  .coach-card:hover { transform: translateY(-3px); box-shadow:0 10px 18px rgba(0,0,0,0.1); }
  .coach-card img { width: 120px; height:120px; border-radius: 50%; display:block; margin:6px auto 10px; }
  .coach-title { font-weight:700; color:#b74387; margin-bottom:6px; }
  .coach-desc { font-size:13px; color:#666; min-height: 3.2em; }
</style>
</head>
<body>
<h1>ğŸ’– ãƒãƒãƒ¼ãƒ©ã‚¤ãƒ•ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ ğŸ’° <span class="pill">eãƒ©ãƒ¼ãƒ‹ãƒ³ã‚°ä½“é¨“ï¼ˆéŸ³å£°ãªã—ï¼‰</span></h1>
<div id="game">
  <div id="status" class="status"></div>
  <div id="event"></div>
  <div id="choices" class="row"></div>
  <div id="coach" class="coach-box"></div>
</div>
<p class="note">â€» ã¾ãšã‚³ãƒ¼ãƒã‚’é¸æŠã—ã¦ãã ã•ã„ï¼ˆæ‰€è¦ç´„7ã€œ10åˆ†ï¼‰ã€‚ç”»åƒã¯å·®ã—æ›¿ãˆå¯èƒ½ã§ã™ã€‚</p>
<script>
// ===== ã‚³ãƒ¼ãƒç”»åƒï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼šã‚¤ãƒ³ãƒ©ã‚¤ãƒ³SVGã‚’data URIåŒ–ï¼‰ =====
const svg = (bg, face) => `data:image/svg+xml;utf8,` + encodeURIComponent(`
  <svg xmlns='http://www.w3.org/2000/svg' width='120' height='120' viewBox='0 0 120 120'>
    <defs>
      <radialGradient id='g' cx='50%' cy='40%' r='70%'>
        <stop offset='0%' stop-color='${bg}' stop-opacity='1'/>
        <stop offset='100%' stop-color='${bg}' stop-opacity='0.85'/>
      </radialGradient>
    </defs>
    <circle cx='60' cy='60' r='58' fill='url(#g)'/>
    ${face}
  </svg>`);
const faceSoft = "<circle cx='60' cy='62' r='34' fill='#ffe7ef'/><circle cx='48' cy='56' r='5' fill='#b66e97'/><circle cx='72' cy='56' r='5' fill='#b66e97'/><path d='M45 72 C60 84, 75 84, 90 72' stroke='#d087b2' stroke-width='4' fill='none' stroke-linecap='round'/>";
const faceSharp = "<circle cx='60' cy='62' r='34' fill='#e9f3ff'/><rect x='45' y='52' width='8' height='4' rx='2' fill='#4c6aa7'/><rect x='68' y='52' width='8' height='4' rx='2' fill='#4c6aa7'/><path d='M44 74 Q60 82 76 74' stroke='#5b79b6' stroke-width='4' fill='none' stroke-linecap='round'/>";
const faceBright = "<circle cx='60' cy='62' r='34' fill='#fff6d9'/><circle cx='48' cy='56' r='6' fill='#d68b00'/><circle cx='72' cy='56' r='6' fill='#d68b00'/><path d='M45 73 Q60 88 75 73' stroke='#f0a600' stroke-width='4' fill='none' stroke-linecap='round'/>";

// ç”»åƒURLã‚’ç‹¬è‡ªã®å†™çœŸã«å·®ã—æ›¿ãˆãŸã„å ´åˆã¯ã€ä¸‹è¨˜ã® src ã‚’ä¸Šæ›¸ãã—ã¦ãã ã•ã„
const coachProfiles = {
  mina: {
    key: 'mina',
    name: 'ãƒŸãƒŠï¼ˆãƒŠãƒãƒ¥ãƒ©ãƒ«ï¼‰',
    // ç”»åƒãƒ‘ã‚¹ã‚’ç½®ããŸã„å ´åˆã¯ images/chara1.jpg ã‚’ç”¨æ„ã€‚ç„¡ã‘ã‚Œã°ä¸‹ã® fallback ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚
    avatarSrc: "images/chara1.jpg",
    fallback: svg('#ffd6e9', faceSoft),
    desc: 'ã‚„ã•ã—ãå¯„ã‚Šæ·»ã†ã‚³ãƒ¼ãƒã€‚ç¿’æ…£ã¥ãã‚ŠãŒå¾—æ„ã€‚',
    quotes: {
      save:["â€œè²¯ã‚ã‚‹åŠ›â€ã¯å®‰å¿ƒã®åœŸå°ã­ã€‚å°ã•ãã¦ã‚‚ç©ã¿ä¸Šã’ã‚ˆã†ã€‚", "å›ºå®šè²»ã®è¦‹ç›´ã—ã¯ã€è‡ªç”±æ™‚é–“ã‚’ç”Ÿã‚€é­”æ³•ã‚ˆã€‚"],
      learn:["çŸ¥è­˜ã¯æœ€å¼·ã®å®‰å…¨è£…ç½®ã€‚å°‘ã—ãšã¤ã§å¤§ä¸ˆå¤«ã€‚", "ãƒ¡ãƒ¢ã‚’æ®‹ã™ã ã‘ã§ã€å­¦ã³ã¯å‘³æ–¹ã«ãªã‚‹ã‚ã€‚"],
      health:["ä½“ã®ãƒ¡ãƒ³ãƒ†ã¯é•·ç”Ÿãé…å½“ã€‚ã‚„ã•ã—ãç¶šã‘ã‚ˆã€‚", "å¥åº·ã¨å®¶è¨ˆã€ã©ã¡ã‚‰ã‚‚â€œæ•´ãˆã‚‹â€ãŒã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã­ã€‚"],
      side:["ãƒãƒ£ãƒ³ã‚¹ã¯å°ã•ãè©¦ã™ã€‚ç¶šã‘ã‚Œã°åŠ›ã«ãªã‚‹ã‚ã€‚", "åå…¥ã®æŸ±ãŒå¢—ãˆã‚‹ã¨ã€æ°—æŒã¡ã‚‚å®‰å®šã™ã‚‹ã®ã€‚"],
      joy:["æ€ã„å‡ºã¯å¹¸ç¦ã®é…å½“ã€‚ä½¿ã†å–œã³ã‚‚å¤§åˆ‡ã«ã­ã€‚", "å¿ƒãŒæº€ãŸã•ã‚Œã‚‹æ”¯å‡ºã¯ã€ã‚ãªãŸã®æ „é¤Šã‚ˆã€‚"],
      invest:["åˆ†æ•£ã¨é•·æœŸã€‚ç„¦ã‚‰ãšè‚²ã¦ã¦ã„ã“ã†ã€‚", "ç©ã¿ç«‹ã¦ã¯â€œæœªæ¥ã®è‡ªåˆ†â€ã¸ã®ãƒ—ãƒ¬ã‚¼ãƒ³ãƒˆã€‚"],
      rebalance:["ç‚¹æ¤œã¯å¥å…¨ã€‚ãƒ«ãƒ¼ãƒ«ã‚’æ±ºã‚ã¦æ·¡ã€…ã¨ã­ã€‚", "æ„Ÿæƒ…ã§ã¯ãªãè¨­è¨ˆå›³ã§å‹•ã‘ãŸã‚‰ååˆ†ã€‚"],
      wait:["â€œå¾…ã¤åŠ›â€ã‚‚ç«‹æ´¾ãªæˆ¦ç•¥ã‚ˆã€‚ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã‚’è¦‹æ¥µã‚ã¦ã€‚", "è¦³å¯Ÿã¯å­¦ã³ã€‚æ…Œã¦ãªãã¦ã„ã„ã®ã€‚"],
      risk:["å¤±æ•—ã¯å­¦ã³ã«å¤‰ã‚ã‚‹ã€‚æ¬¡ã¯ã‚‚ã£ã¨ä¸Šæ‰‹ãã„ãã‚ã€‚"],
      plan:["ç›®çš„åˆ¥ã«åˆ†ã‘ã‚‹ã¨ã€è¿·ã„ãŒæ¸›ã£ã¦ç¶šã‘ã‚„ã™ã„ã‚ˆã€‚"],
      protect:["å®ˆã‚Šã‚’æ•´ãˆã‚‹ã¨ã€æ”»ã‚ã‚‚è½ã¡ç€ã„ã¦ã§ãã‚‹ã®ã€‚"],
      overseas:["ä¸–ç•Œã«åˆ†æ•£ã™ã‚‹ã®ã¯ã€â€œä¸–ç•Œã§ãŠé‡‘ã‚’åƒã‹ã›ã‚‹â€ã“ã¨ã€‚ãƒ‰ãƒ«ã‚„ç‚ºæ›¿ã‚‚ã‚†ã£ãã‚Šå­¦ã¼ã†ã€‚"],
      ending:["ã“ã®ä¸€å¹´ã€ã‚ˆããŒã‚“ã°ã£ãŸã­ã€‚ç©ã¿é‡ã­ã¯è£åˆ‡ã‚‰ãªã„ã‚ˆã€‚", "æ•°å­—ã‚ˆã‚Šã€è€ƒãˆæ–¹ãŒè‚²ã£ãŸã“ã¨ãŒã„ã¡ã°ã‚“ã®æˆæœã‚ˆã€‚"]
    }
  },
  rei: {
    key: 'rei',
    name: 'ãƒ¬ã‚¤ï¼ˆã‚­ãƒ£ãƒªã‚¢ï¼‰',
    avatarSrc: "images/chara2.jpg",
    fallback: svg('#d9e7ff', faceSharp),
    desc: 'ã‚­ãƒªãƒƒã¨ãƒ­ã‚¸ã‚«ãƒ«ã€‚è¨­è¨ˆÃ—å®Ÿè¡Œã§ä¼´èµ°ã€‚',
    quotes: {
      save:["å›ºå®šè²»ã®æœ€é©åŒ– = å¯å‡¦åˆ†æ™‚é–“ã®å‰µå‡ºã ã€‚", "å…ˆã«â€œãƒ«ãƒ¼ãƒ«â€ã‚’æ±ºã‚ã‚Œã°è¿·ã‚ãªã„ã€‚"],
      learn:["çŸ¥è­˜ã¯æœ€å¼·ã®ã‚»ãƒ¼ãƒ•ãƒ†ã‚£ãƒãƒƒãƒˆã€‚é€±1ã®å­¦ã³ã‚’ã€‚", "ãƒ¡ãƒ¢ã¨æŒ¯ã‚Šè¿”ã‚Šã§å†ç¾æ€§ã‚’ä¸Šã’ã‚ˆã†ã€‚"],
      health:["è³‡ç”£å½¢æˆã¯é•·è·é›¢èµ°ã€‚ä½“èª¿ç®¡ç†ã¯KPIã ã€‚", "å°ã•ãªç¶™ç¶šãŒè¤‡åˆ©ã‚’ç”Ÿã‚€ã€‚"],
      side:["å°ã•ãè©¦ã—ã€æ•°å­—ã§è©•ä¾¡ã™ã‚‹ã€‚", "åå…¥ã®æŸ±ã‚’å¢—ã‚„ã›ã°è€æ€§ãŒä¸ŠãŒã‚‹ã€‚"],
      joy:["äºˆç®—åŒ–ã•ã‚ŒãŸä½™æš‡ã¯ã€é•·ç¶šãã™ã‚‹ã€‚", "å¹¸ç¦ã®ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã‚’æ„è­˜ã—ã‚ˆã†ã€‚"],
      invest:["é•·æœŸãƒ»åˆ†æ•£ãƒ»ä½ã‚³ã‚¹ãƒˆï¼šã“ã®åŸå‰‡ã‚’å®ˆã‚Œã€‚", "ç©ã¿ç«‹ã¦ã¯â€œæœªæ¥ã®è‡ªåˆ†ã¸ã®çµ¦ä¸â€ã€‚"],
      rebalance:["å¹´1ã€œ2å›ã®ãƒªãƒãƒ©ãƒ³ã‚¹ã‚’ãƒ«ãƒ¼ãƒãƒ³åŒ–ã€‚", "æ„Ÿæƒ…ã§ã¯ãªãè¨­è¨ˆå›³ã«å¾“ãŠã†ã€‚"],
      wait:["å¾…ã¤åˆ¤æ–­ã‚‚æˆ¦ç•¥ã€‚å¸‚å ´ã¯å¸¸ã«ã‚ã‚‹ã€‚", "è¦³å¯Ÿâ†’ä»®èª¬â†’æ¬¡ã®ä¸€æ‰‹ã€‚"],
      risk:["å¤±æ•—ã¯ãƒ‡ãƒ¼ã‚¿ã€‚å­¦ã³ã«å¤‰æ›ã—ã¦æ¬¡ã¸ã€‚"],
      plan:["ç›®çš„åˆ¥ã®è³‡é‡‘é…åˆ†ã§è¿·ã„ã‚’å‰Šæ¸›ã€‚"],
      protect:["å®ˆã‚ŠãŒæ•´ã†ã»ã©æ”»ã‚ã‚‰ã‚Œã‚‹ã€‚ãƒãƒ©ãƒ³ã‚¹ã ã€‚"],
      overseas:["é€šè²¨ãƒ»åœ°åŸŸã®åˆ†æ•£ã§ãƒœãƒ©è€æ€§ã‚’ä¸Šã’ã‚‹ã€‚"],
      ending:["æ€è€ƒã®ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆãŒæœ€å¤§ã®æˆæœã ã€‚ã‚ˆãã‚„ã£ãŸã€‚"]
    }
  },
  aoi: {
    key: 'aoi',
    name: 'ã‚¢ã‚ªã‚¤ï¼ˆãƒ•ã‚§ãƒŸãƒ‹ãƒ³ï¼‰',
    avatarSrc: "images/chara3.jpg",
    fallback: svg('#fff0c9', faceBright),
    desc: 'æ˜ã‚‹ãå‰å‘ãã€‚ãƒ¢ãƒãƒ™UPæ‹…å½“ï¼',
    quotes: {
      save:["ã¡ã‚‡ã£ã¨ã®å·¥å¤«ã§æœªæ¥ãŒãµã‚ã£ã¨è»½ããªã‚‹ã‚ˆï¼", "å›ºå®šè²»ã‚’ã‚¹ãƒªãƒ ã«ã—ã¦ã€ã‚„ã‚ŠãŸã„ã“ã¨å¢—ã‚„ãâ™ª"],
      learn:["å­¦ã³ã¯ã”ã»ã†ã³ã€‚ä»Šæ—¥ã®ã²ã¨ã“ã¨ãƒ¡ãƒ¢ã‹ã‚‰ï¼", "çŸ¥ã£ã¦ã‚‹ã ã‘ã§ãƒ‰ã‚­ãƒ‰ã‚­ãŒãƒ¯ã‚¯ãƒ¯ã‚¯ã«ã€‚"],
      health:["ã‚³ã‚³ãƒ­ã¨ã‚«ãƒ©ãƒ€ã®ãƒ¡ãƒ³ãƒ†ã€ã„ã£ã—ã‚‡ã«ç¶šã‘ã‚ˆï¼", "å¥åº·ã¯ãƒãƒƒãƒ”ãƒ¼é…å½“ï¼"],
      side:["å°ã•ãå§‹ã‚ã‚‹â†’ç¶šã‘ã‚‹â†’æ°—ã¥ã„ãŸã‚‰ç©ã¿ä¸ŠãŒã£ã¦ã‚‹ï¼", "ã‚ãã‚ãã™ã‚‹æŒ‘æˆ¦ã€1æ­©ã„ã£ã¦ã¿ã‚ˆâ™ª"],
      joy:["æ€ã„å‡ºã¯ãšã£ã¨æ®‹ã‚‹è³‡ç”£ã ã‚ˆã€œï¼", "ã†ã‚Œã—ã„æ”¯å‡ºã¯ã€å¿ƒã®æ „é¤Šâ™¡"],
      invest:["ã‚³ãƒ„ã‚³ãƒ„æœ€å¼·ï¼é•·æœŸãƒ»åˆ†æ•£ã§ã®ã‚“ã³ã‚Šè‚²ã¦ã‚ˆã€‚", "æœªæ¥ã®è‡ªåˆ†ã¸ã®ãƒ—ãƒ¬ã‚¼ãƒ³ãƒˆã€ä»Šæ—¥ã‚‚1å£â™ª"],
      rebalance:["ã¨ãã©ãæ•´ãˆã‚‹ã ã‘ã§ã‚¹ãƒƒã‚­ãƒªï¼", "è¨­è¨ˆå›³ã©ãŠã‚Šã«æˆ»ã›ã°OKã ã‚ˆã€œã€‚"],
      wait:["ã‚ã›ã‚‰ãªã„ã€ä»Šã¯è¦³å¯Ÿã‚¿ã‚¤ãƒ ã ã­ï¼", "æ¬¡ã®ãƒãƒ£ãƒ³ã‚¹ã€ãœã£ãŸã„æ¥ã‚‹ã‚ˆï¼"],
      risk:["ã†ã¾ãã„ã‹ãªã„æ—¥ã‚‚ã€å­¦ã³ãƒã‚¤ãƒ³ãƒˆGETï¼"],
      plan:["ç›®çš„åˆ¥ã§ã‚ã‘ã‚ã‘ã€è¿·ã‚ãšGOï¼"],
      protect:["å®ˆã‚ŠãŒã‚ã‚Œã°å®‰å¿ƒã—ã¦é€²ã‚ã‚‹ã‚ˆã­â™¡"],
      overseas:["ä¸–ç•Œã«ã²ã‚ã’ã¦ã€æœªæ¥ã‚‚ãƒ¯ã‚¯ãƒ¯ã‚¯ã«ï¼"],
      ending:["1å¹´ãŠã¤ã‹ã‚Œã•ã¾ï¼ãœã‚“ã¶ãƒã‚«ãƒ©ã«ãªã£ã¦ã‚‹ã‚ˆâ™ª"]
    }
  }
};

let selectedCoach = null; // {key, name, avatarSrc, quotes}

// ===== ã‚²ãƒ¼ãƒ æœ¬ä½“ï¼ˆæ—¢å­˜ï¼‰ =====
const monthlyEvents = [
  { m: '1æœˆ', text: 'æ–°å¹´ã®æŠ±è² ã€‚ã¾ãšä½•ã‹ã‚‰å§‹ã‚ã‚‹ï¼Ÿ', choices:[
    {label:'å®¶è¨ˆã®è¦‹ç›´ã—ï¼ˆå›ºå®šè²»ã‚’å‰Šæ¸›ï¼‰', money:+4000, happy:+2, know:+5, tag:'save'},
    {label:'å°ã•ãæŠ•è³‡ã‚’å§‹ã‚ã‚‹ï¼ˆã¤ã¿ãŸã¦ï¼‰', money:-3000, happy:+4, know:+8, tag:'invest'},
    {label:'å­¦ã³ã«æŠ•è³‡ï¼ˆå…¥é–€è¬›åº§ï¼‰', money:-2000, happy:+5, know:+12, tag:'learn'}
  ]},
  { m: '2æœˆ', text: 'å¥åº·è¨ºæ–­ã®çµæœãŒå±Šã„ãŸ', choices:[
    {label:'é‹å‹•ç¿’æ…£ã‚’ä½œã‚‹ï¼ˆã‚¸ãƒ ï¼‰', money:-4000, happy:+10, know:+3, tag:'health'},
    {label:'é£Ÿäº‹æ”¹å–„ï¼†æ•£æ­©ã‚’ç¶™ç¶š', money:-500, happy:+7, know:+2, tag:'health'},
    {label:'å…ˆå»¶ã°ã—ã«ã™ã‚‹', money:0, happy:-6, know:0, tag:'risk'}
  ]},
  { m: '3æœˆ', text: 'å‰¯æ¥­ã®ãƒãƒ£ãƒ³ã‚¹ãŒåˆ°æ¥ï¼', choices:[
    {label:'å°ã•ãæŒ‘æˆ¦ã—ã¦ã¿ã‚‹', money:+8000, happy:+4, know:+6, tag:'side'},
    {label:'ä»Šã¯å­¦ã³ã‚’å„ªå…ˆ', money:-1000, happy:+3, know:+8, tag:'learn'},
    {label:'ç”Ÿæ´»ã‚’æ•´ãˆã‚‹ã“ã¨ã«é›†ä¸­', money:0, happy:+3, know:0, tag:'rest'}
  ]},
  { m: '4æœˆ', text: 'å‹äººã‹ã‚‰æ—…è¡Œã®èª˜ã„', choices:[
    {label:'æ€ã„åˆ‡ã£ã¦è¡Œã', money:-8000, happy:+18, know:+3, tag:'joy'},
    {label:'ä»Šå›ã¯æ§ãˆã¦è²¯è“„', money:+0, happy:-5, know:+1, tag:'save'},
    {label:'è¿‘å ´ã§æ—¥å¸°ã‚Šã«', money:-2000, happy:+10, know:+1, tag:'joy'}
  ]},
  { m: '5æœˆ', text: 'ç›¸å ´ã®å€¤å‹•ããŒæ°—ã«ãªã‚‹', choices:[
    {label:'åˆ†æ•£ã‚’æ„è­˜ã—ã¦å°‘é¡è¿½åŠ ', money:-4000, happy:+3, know:+8, tag:'invest'},
    {label:'ä¸€éƒ¨ã‚’åˆ©ç›Šç¢ºå®š', money:+3000, happy:-2, know:-2, tag:'rebalance'},
    {label:'ç©ã¿ç«‹ã¦ã®ã¿ç¶™ç¶š', money:0, happy:+2, know:+4, tag:'wait'}
  ]},
  { m: '6æœˆ', text: 'æµ·å¤–æŠ•è³‡ã‚’æ¤œè¨ï¼ˆETF/æŠ•ä¿¡ï¼‰', choices:[
    {label:'ç±³å›½ETFã‚’å°‘é¡è³¼å…¥', money:-5000, happy:+4, know:+10, tag:'overseas'},
    {label:'ç‚ºæ›¿ã‚’å­¦ã‚“ã§ã‹ã‚‰å§‹ã‚ã‚‹', money:0, happy:+3, know:+8, tag:'learn'},
    {label:'å›½å†…ä¸­å¿ƒã§ç¶™ç¶š', money:0, happy:+2, know:+2, tag:'save'}
  ]},
  { m: '7æœˆ', text: 'ãƒ‹ãƒ¥ãƒ¼ã‚¹ï¼šå††å®‰ãŒé€²è¡Œ', choices:[
    {label:'å¤–è²¨å»ºã¦ã®å‰²åˆã‚’ç‚¹æ¤œ', money:0, happy:+1, know:+8, tag:'rebalance'},
    {label:'å¤–è²¨ç©ç«‹ã‚’å°‘é¡é–‹å§‹', money:-3000, happy:+3, know:+6, tag:'overseas'},
    {label:'æ§˜å­ã‚’è¦‹ã‚‹', money:0, happy:+0, know:+2, tag:'wait'}
  ]},
  { m: '8æœˆ', text: 'NISAæ‹¡å……ã®ç‰¹é›†ã‚’è¦–è´', choices:[
    {label:'ã¤ã¿ãŸã¦æ ã‚’å¢—é¡', money:-4000, happy:+4, know:+8, tag:'invest'},
    {label:'æˆé•·æŠ•è³‡æ ã‚’ä¸€éƒ¨æ´»ç”¨', money:-3000, happy:+3, know:+7, tag:'invest'},
    {label:'ãƒ¡ãƒ¢ã ã‘æ®‹ã—ã¦æ¤œè¨', money:0, happy:+1, know:+4, tag:'wait'}
  ]},
  { m: '9æœˆ', text: 'ç‰©ä¾¡ä¸Šæ˜‡ã§ç”Ÿæ´»ã‚³ã‚¹ãƒˆãŒä¸ŠãŒã‚‹', choices:[
    {label:'å›ºå®šè²»ã®å†è¦‹ç›´ã—', money:+3000, happy:+1, know:+6, tag:'save'},
    {label:'åå…¥ã‚¢ãƒƒãƒ—ç­–ã‚’æ¢ã™', money:0, happy:+2, know:+6, tag:'side'},
    {label:'ãƒã‚¤ãƒ³ãƒˆæ´»ç”¨ãƒ»å®¶è¨ˆè¡“', money:+1000, happy:+2, know:+3, tag:'save'}
  ]},
  { m: '10æœˆ', text: 'å®¶æ—ã®å‡ºè²»ã‚¤ãƒ™ãƒ³ãƒˆï¼ˆæ•™è‚²/ä»‹è­·ãªã©ï¼‰', choices:[
    {label:'ç›®çš„åˆ¥å£åº§ã‹ã‚‰æ»å‡º', money:-5000, happy:+4, know:+2, tag:'plan'},
    {label:'æŠ•è³‡ã®ä¸€éƒ¨ã‚’å–ã‚Šå´©ã™', money:+4000, happy:-2, know:-3, tag:'rebalance'},
    {label:'æ”¯å‡ºã‚’åˆ†å‰²ã—è¨ˆç”»åŒ–', money:-2000, happy:+3, know:+3, tag:'plan'}
  ]},
  { m: '11æœˆ', text: 'è³‡ç”£ã‚’å®ˆã‚‹ï¼šä¿é™ºã¨ãƒªã‚¹ã‚¯å¯¾ç­–', choices:[
    {label:'ä¿éšœå†…å®¹ã‚’ç‚¹æ¤œãƒ»æœ€é©åŒ–', money:+1000, happy:+2, know:+6, tag:'protect'},
    {label:'æœ€ä½é™ã«è¦‹ç›´ã—', money:+2000, happy:+1, know:+4, tag:'protect'},
    {label:'å¤‰æ›´ã—ãªã„', money:0, happy:0, know:+1, tag:'wait'}
  ]},
  { m: '12æœˆ', text: '1å¹´ã®æŒ¯ã‚Šè¿”ã‚Šã¨æ¥å¹´ã®è¨­è¨ˆ', choices:[
    {label:'è‡ªå‹•ç©ç«‹ï¼†ãƒªãƒãƒ©ãƒ³ã‚¹è¨­å®š', money:0, happy:+4, know:+8, tag:'rebalance'},
    {label:'æ¥å¹´ã®ç›®æ¨™ã¨äºˆç®—ã‚’ä½œæˆ', money:0, happy:+5, know:+6, tag:'plan'},
    {label:'ã”è¤’ç¾ã«å°ã•ãªæ—…è¡Œ', money:-3000, happy:+14, know:+2, tag:'joy'}
  ]}
];

let turn = 0; // 0..11
let money = 50000; // åˆæœŸæ‰€æŒé‡‘
let happy = 50;
let know = 10;
const tagPickCount = {}; // é¸æŠå‚¾å‘ã®é›†è¨ˆ

function updateStatus(){
  const monthLabel = monthlyEvents[turn] ? monthlyEvents[turn].m : 'çµæœ';
  document.getElementById('status').innerHTML =
    `ğŸ“… ${monthLabel}ã€€ï¼ˆ${Math.min(turn+1,12)}/12ï¼‰<br>`+
    `ğŸ’µ æ‰€æŒé‡‘: ï¿¥${money}ã€€`+
    `ğŸ’– å¹¸ç¦åº¦: ${happy}ã€€`+
    `ğŸ§  çŸ¥è­˜åº¦: ${know}`;
}

function renderCoachSelect(){
  const eventEl = document.getElementById('event');
  const ch = document.getElementById('choices');
  const coachBox = document.getElementById('coach');
  document.getElementById('status').innerHTML = 'ğŸ‘©â€ğŸ« ã¾ãšã¯ã‚³ãƒ¼ãƒã‚’é¸ã‚“ã§ãã ã•ã„';
  coachBox.style.display = 'none';

  const cards = Object.values(coachProfiles).map(p => `
    <div class='coach-card'>
      <img src='${p.avatarSrc}' alt='${p.name}' onerror="this.onerror=null; this.src='${p.fallback}'">
      <div class='coach-title'>${p.name}</div>
      <div class='coach-desc'>${p.desc}</div>
      <button data-key='${p.key}'>ã“ã®ã‚³ãƒ¼ãƒã‚’é¸ã¶</button>
    </div>`).join('');

  eventEl.innerHTML = `<h3>ã‚³ãƒ¼ãƒã‚’é¸æŠ</h3><p>é›°å›²æ°—ã®åˆã†ã‚³ãƒ¼ãƒã‚’é¸ã‚“ã§ã€1å¹´ã®æ—…ã‚’å§‹ã‚ã¾ã—ã‚‡ã†ã€‚</p>`;
  ch.classList.remove('row');
  ch.innerHTML = `<div class='select-wrap'>${cards}</div>`;

  ch.querySelectorAll('button[data-key]').forEach(btn => {
    btn.onclick = () => {
      const key = btn.getAttribute('data-key');
      startGameWithCoach(key);
    };
  });
}

function startGameWithCoach(key){
  selectedCoach = coachProfiles[key];
  turn = 0; money = 50000; happy = 50; know = 10;
  for(const k in tagPickCount){ delete tagPickCount[k]; }
  document.getElementById('choices').classList.add('row');
  nextEvent();
  showCoach('plan'); // æœ€åˆã«è»½ãæŒ¨æ‹¶
}

function showCoach(tag){
  const box = document.getElementById('coach');
  if(!selectedCoach){ box.style.display='none'; return; }
  const list = (selectedCoach.quotes && selectedCoach.quotes[tag]) || ["å°ã•ãªä¸€æ­©ãŒã€æœªæ¥ã‚’å¤‰ãˆã‚‹ã‚ã€‚"];
  const line = list[Math.floor(Math.random()*list.length)];
  box.style.display = 'flex';
  box.innerHTML = `
    <div class="coach-avatar"><img src='${selectedCoach.avatarSrc}' alt='${selectedCoach.name}' onerror="this.onerror=null; this.src='${selectedCoach.fallback}'"></div>
    <div class="coach-text">
      <div class="coach-name">${selectedCoach.name}</div>
      <div>${line}</div>
    </div>`;
  // å†ç”Ÿã‚¢ãƒ‹ãƒ¡
  box.style.animation = 'none';
  void box.offsetWidth; // reflow
  box.style.animation = 'fadeInUp 0.8s ease forwards';
}

function nextEvent(){
  // ã‚³ãƒ¼ãƒæœªé¸æŠãªã‚‰é¸æŠç”»é¢ã¸
  if(!selectedCoach){ renderCoachSelect(); return; }
  if(turn >= monthlyEvents.length){ endGame(); return; }
  const e = monthlyEvents[turn];
  document.getElementById('event').innerHTML = `<strong>${e.m}</strong><br><p>${e.text}</p>`;
  const ch = document.getElementById('choices');
  ch.innerHTML = '';
  e.choices.forEach(c => {
    const b = document.createElement('button');
    b.textContent = c.label;
    b.onclick = () => {
      sparkleEffect();
      money += c.money; happy += c.happy; know += c.know;
      tagPickCount[c.tag] = (tagPickCount[c.tag]||0)+1;
      showCoach(c.tag);
      turn++;
      updateStatus();
      setTimeout(nextEvent, 550); // ä½™éŸ»å¾Œã«æ¬¡ã¸
    };
    ch.appendChild(b);
  });
  updateStatus();
}

function endGame(){
  let type = '';
  if(happy > 70 && money > 60000) type = 'ğŸ’ ãƒãƒ©ãƒ³ã‚¹ç¾äººã‚¿ã‚¤ãƒ—';
  else if(happy > 70) type = 'ğŸŒ· ãƒãƒ¼ãƒˆãƒ•ãƒ«ã‚¿ã‚¤ãƒ—';
  else if(know > 55) type = 'ğŸ“ˆ ãƒãƒ£ãƒ¬ãƒ³ã‚¸ãƒ£ãƒ¼ã‚¿ã‚¤ãƒ—';
  else type = 'ğŸ’­ ãƒã‚¤ãƒšãƒ¼ã‚¹ã‚¿ã‚¤ãƒ—';

  // å€‹åˆ¥ã‚¢ãƒ‰ãƒã‚¤ã‚¹ï¼ˆç°¡æ˜“ï¼‰
  const tips = [];
  if((tagPickCount.overseas||0)===0) tips.push('æµ·å¤–åˆ†æ•£ã®ä¸€æ­©ã‚’æ¥å¹´ã¯æ¤œè¨ã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼ˆETF/æŠ•ä¿¡ã®å°‘é¡ã‹ã‚‰ï¼‰ã€‚');
  if((tagPickCount.rebalance||0)<2) tips.push('å¹´1ã€œ2å›ã®â€œãƒªãƒãƒ©ãƒ³ã‚¹â€ã§ã€æ„Ÿæƒ…ã§ã¯ãªãè¨­è¨ˆã§é‹ç”¨ã‚’ã€‚');
  if(know < 40) tips.push('å­¦ã³ãƒ¡ãƒ¢ã‚’æ®‹ã—ã¦ã€çŸ¥è­˜ã‚’â€œè¦‹ãˆã‚‹åŒ–â€ã—ã¾ã—ã‚‡ã†ã€‚');
  if((tagPickCount.health||0)===0) tips.push('å¥åº·ã¯é•·ç”Ÿãé…å½“ã€‚å°ã•ãç¶šã‘ã‚‹ç¿’æ…£ã‚’ã€‚');

  document.getElementById('event').innerHTML = `
    <h3>çµæœç™ºè¡¨</h3>
    <p>ã‚ãªãŸã¯ <strong>${type}</strong> ã§ã—ãŸã€‚</p>
    <div style="text-align:left; max-width:600px; margin:12px auto; background:#fff7fb; border:1px solid #f0cfe1; padding:12px; border-radius:10px;">
      <strong>è¬›åº§ãƒã‚¤ãƒ³ãƒˆï¼ˆè¦ç‚¹ï¼‰</strong>
      <ul>
        <li>é•·æœŸãƒ»åˆ†æ•£ãƒ»ç¶™ç¶šãŒåŸºæœ¬ã€‚ç©ã¿ç«‹ã¦ã¯æœªæ¥ã¸ã®ãƒ—ãƒ¬ã‚¼ãƒ³ãƒˆã€‚</li>
        <li>æµ·å¤–æŠ•è³‡ã¯â€œä¸–ç•Œã§ãŠé‡‘ã‚’åƒã‹ã›ã‚‹â€ã“ã¨ã€‚é€šè²¨ãƒªã‚¹ã‚¯ã¯å­¦ã³ã§è»½æ¸›ã€‚</li>
        <li>å›ºå®šè²»ã®è¦‹ç›´ã—ã¨ç›®çš„åˆ¥å£åº§ã§ã€è¿·ã„ã‚’æ¸›ã‚‰ã—ã¦ç¶šã‘ã‚„ã™ãã€‚</li>
        <li>å¹´1ã€œ2å›ã®ãƒªãƒãƒ©ãƒ³ã‚¹ã§ã€è¨­è¨ˆå›³ã«æ²¿ã£ãŸé‹ç”¨ã‚’ã€‚</li>
      </ul>
      <div style="text-align:center; margin-top:14px;">
        <a href="https://www.instagram.com/kaorin_family/" target="_blank" style="display:inline-block; background:#d06ba0; color:#fff; padding:10px 18px; border-radius:8px; text-decoration:none; font-weight:600; text-decoration:none;">
          ğŸ’¡ ãŠé‡‘ã®ã‚»ãƒŸãƒŠãƒ¼ã«å‚åŠ ã™ã‚‹ï¼ˆç”³ã—è¾¼ã¿ï¼‰
        </a>
      </div>
      ${tips.length?('<strong>ã‚ãªãŸã¸ã®ã²ã¨ã“ã¨</strong><ul>'+tips.map(t=>`<li>${t}</li>`).join('')+'</ul>'):''}
    </div>
  `;
  document.getElementById('choices').innerHTML = '<button onclick="location.reload()">ã‚‚ã†ä¸€åº¦éŠã¶ï¼ˆã‚³ãƒ¼ãƒé¸ã³ã‹ã‚‰ï¼‰</button>';
  showCoach('ending');
  sparkleEffect(40);
}

function sparkleEffect(count=10){
  for(let i=0;i<count;i++){
    const s=document.createElement('div');
    s.className='sparkle';
    s.style.left=Math.random()*100+'vw';
    s.style.animationDuration=(3+Math.random()*2)+'s';
    document.body.appendChild(s);
    setTimeout(()=>s.remove(),4000);
  }
}

// é–‹å§‹ï¼šã¾ãšã¯ã‚³ãƒ¼ãƒé¸æŠç”»é¢
nextEvent();
</script>
</body>
</html>
